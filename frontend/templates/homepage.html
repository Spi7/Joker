<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dou Dizhu Lobby</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/homepage.css') }}"/>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/navbar.css') }}">
    <link rel="icon"
          href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>🃏</text></svg>">

    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
    <script src="{{ url_for('static', filename='js/homepage.js') }}" defer></script>
</head>
<body>

<nav class="game-navbar">
    <div class="navbar-logo">
        <span class="card-symbol">♠ ♥ ♣ ♦</span>
        <span class="navbar-title">Landlord</span>
    </div>
    <div class="navbar-links">
        <a href="/homepage" class="nav-link" id="nav-home">
            <span class="nav-icon">🏠</span>
            <span class="nav-text">Home</span>
        </a>
        <a href="/leaderboard" class="nav-link" id="nav-leaderboard">
            <span class="nav-icon">🏆</span>
            <span class="nav-text">Leaderboard</span>
        </a>
        <a href="/profile" class="nav-link" id="nav-profile">
            <span class="nav-icon">👤</span>
            <span class="nav-text">Profile</span>
        </a>
    </div>
</nav>

<!-- Music -->
<audio id="bg-music" loop autoplay>
    <source src="{{ url_for('static', filename='audio/lobby.mp3') }}" type="audio/mpeg"/>
</audio>
<button id="music-toggle" onclick="toggleMusic()" class="music-toggle">
    🎵 Music On
</button>

<!-- Game Rules Button -->
<button id="rules-btn" class="rules-button">❓ Rules</button>

<!-- Title -->
<h1 class="game-title">Landlord 🎴</h1>

<!-- Buttons -->
<div class="button-row single-center">
    <button id="create-room-btn" class="jelly-button green large-btn">➕ Create Room</button>
</div>

<!-- Room List -->
<div class="room-list">
    <h2>Available Rooms</h2>
    <div class="room-scroll">
        {% for room in rooms %}
        <div class="room-card">
            <div class="room-info">
                <p class="room-name">Room {{ room.id }}</p>
                <p class="room-players">Players: {{ room.players | length }}/3</p>
            </div>
            <a href="/join-room/{{ room.id }}" class="join-btn">Join</a>
        </div>
        {% endfor %}
        {# {% if rooms|length == 0 %}#}
        {# <p class="no-room">No rooms available. Be the first to create one!</p>#}
        {# {% endif %}#}
    </div>
</div>

{# Pop up modal for max room capacity message #}
<div id="modal-overlay" class="modal-overlay hidden">
    <div class="room-card modal-box">
        <div class="room-info">
            <p class="room-name">Room is full!!!</p>
            <p class="room-players">
                This room already has 3 players. Please join another room!
            </p>
        </div>
        <button id="close-modal" class="join-btn">OK</button>
    </div>
</div>

<div id="rules-modal" class="modal-overlay hidden">
    <div class="modal-box">
        <div class="room-info">
            <h2 class="room-name">🃏 Game Rules</h2>
            <p>- Each game includes <strong>3 players</strong>.</p>
            <p>- At the start, every player receives <strong>18 cards</strong>.</p>
            <p>- A visible <strong>3-second countdown</strong> will begin before the game starts.</p>
            <p>- You will see a <strong>“Grab” button</strong> next to each of your two opponents.<br>
                Clicking this lets you <strong>steal one random card</strong> from that player.</p>
            <p>- You can <strong>only grab from other players</strong>, not yourself.</p>
            <p>- You may <strong>only play pairs</strong> — two cards of the same value, like two 5s or two Queens.</p>
            <p>- This is a <strong>real-time free-for-all battle</strong>, not a turn-based game. You can play your
                cards at any moment!</p>
            <p>- The first player to play all their cards <strong>wins</strong> the game.</p>
        </div>

        <div class="modal-btn-container">
            <button id="close-rules" class="modal-close-btn">OK</button>
        </div>
    </div>
</div>
</body>
</html>